1:"$Sreact.fragment"
2:"$Sreact.strict_mode"
4:I[1063,[],""]
5:I[11483,[],""]
7:I[95125,[],"OutletBoundary"]
a:I[95125,[],"ViewportBoundary"]
c:I[95125,[],"MetadataBoundary"]
e:I[31954,[],""]
:HL["/bayes-bits-brains/_next/static/media/1f3fe8c6df3d47c1-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/bayes-bits-brains/_next/static/media/558ca1a6aa3cb55e-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/bayes-bits-brains/_next/static/css/dbd2812aeb31ae93.css","style"]
:HL["/bayes-bits-brains/_next/static/css/5eacd01f773eed7f.css","style"]
:HL["/bayes-bits-brains/_next/static/css/622677e989ec6b9c.css","style"]
:HL["/bayes-bits-brains/_next/static/css/8870e1553eaf2585.css","style"]
:HL["/bayes-bits-brains/_next/static/css/13ab9833c5f6a889.css","style"]
0:{"P":null,"b":"G9LV8pwmmB789ZWVZT0j8","p":"/bayes-bits-brains","c":["","02-crossentropy",""],"i":false,"f":[[["",{"children":[["path","02-crossentropy","c"],{"children":["__PAGE__",{}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/bayes-bits-brains/_next/static/css/dbd2812aeb31ae93.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/bayes-bits-brains/_next/static/css/5eacd01f773eed7f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/bayes-bits-brains/_next/static/css/622677e989ec6b9c.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","3",{"rel":"stylesheet","href":"/bayes-bits-brains/_next/static/css/8870e1553eaf2585.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","4",{"rel":"stylesheet","href":"/bayes-bits-brains/_next/static/css/13ab9833c5f6a889.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"__variable_871a3d __variable_e566b6","children":["$","$2",null,{"children":[["$","body",null,{"className":"antialiased","children":"$L3"}],"$undefined"]}]}]]}],{"children":[["path","02-crossentropy","c"],["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L6","$undefined",null,["$","$L7",null,{"children":["$L8","$L9",null]}]]}],{},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","qUgkKQrhalg8TCl04B1y0",{"children":[["$","$La",null,{"children":"$Lb"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}],["$","$Lc",null,{"children":"$Ld"}]]}],false]],"m":"$undefined","G":["$e","$undefined"],"s":false,"S":true}
f:I[79444,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
10:I[60544,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
11:I[5340,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
12:I[47950,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],""]
3:["$","div",null,{"className":"min-h-screen flex flex-col bg-white","children":[["$","$Lf",null,{}],["$","$L10",null,{}],["$","div",null,{"className":"flex-1","children":[["$","$L11",null,{"className":"xl:w-60 lg:w-52 hidden lg:block fixed top-16 bottom-0 pt-16 text-base","style":{"left":"var(--sidebar-offset)"}}],["$","main",null,{"className":"Page_main__cWiGN max-w-[var(--content-width)] mx-auto px-4 pt-12 pb-8","children":["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","div",null,{"className":"min-h-screen flex items-center justify-center bg-gray-50","children":["$","div",null,{"className":"max-w-md w-full text-center","children":[["$","h1",null,{"className":"text-6xl font-bold text-gray-900 mb-4","children":"404"}],["$","h2",null,{"className":"text-2xl font-semibold text-gray-700 mb-4","children":"Page Not Found"}],["$","p",null,{"className":"text-gray-600 mb-8","children":"The page you're looking for doesn't exist or has been moved."}],["$","$L12",null,{"href":"/","className":"inline-block bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors","children":"Go Home"}]]}]}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]]}],["$","footer",null,{"className":"mt-4","children":["$","div",null,{"className":"max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8","children":["$","div",null,{"className":"pt-4 pb-12","style":{"marginLeft":"calc(max((100% - var(--content-width)) / 2 + 1rem, 0rem))"},"children":["$","p",null,{"className":"text-base text-neutral-500"}]}]}]}]]}]
13:I[10572,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"EquationProvider"]
14:I[36185,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"CitationsProvider"]
15:I[44464,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"FootnotesProvider"]
16:I[66704,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
17:I[75154,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
18:I[5770,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
19:I[61803,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
1a:I[32480,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
1b:I[916,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
1c:I[23229,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"default"]
1d:I[44464,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"Footnote"]
1e:I[44464,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"Footnotes"]
1f:I[36185,["683","static/chunks/45233be0-cba42a3c5454822d.js","338","static/chunks/4bbad5ef-2b7eebeba98386a5.js","932","static/chunks/f885ef2c-649d91f122a11dff.js","755","static/chunks/0133708f-65d46efc97e0f93d.js","269","static/chunks/91c6c604-01c8ba6fb8219fe8.js","950","static/chunks/950-e6e0e01ad2983f53.js","390","static/chunks/390-7b8633ed8924eb08.js","582","static/chunks/582-781968895face3a7.js","180","static/chunks/app/%5B...path%5D/page-4c83be7a70b80924.js"],"References"]
6:["$","$L13",null,{"children":["$","$L14",null,{"data":{},"children":["$","$L15",null,{"children":["$","article",null,{"className":"Page_article__A_Nud prose prose-neutral max-w-none","children":[[["$","h1",null,{"children":"KL properties & (cross-)entropy"}],"\n",["$","p",null,{"children":["In this chapter, we'll see how KL divergence can be split into two pieces called ",["$","em",null,{"children":"cross-entropy"}]," and ",["$","em",null,{"children":"entropy"}],"."]}],"\n",["$","div",null,{"className":"my-6 rounded-lg overflow-hidden bg-amber-50 border border-amber-200","children":[["$","div",null,{"className":"px-4 py-3 border-b border-amber-200","children":["$","div",null,{"className":"font-medium text-base text-amber-800 flex items-center gap-2","children":[["$","span",null,{"className":"text-lg","children":"💡"}],"If there is one thing you remember from this chapter..."]}]}],["$","div",null,{"className":"px-4 py-3 text-base leading-relaxed text-gray-700","children":["$","p",null,{"children":[["$","$L16",null,{"src":"02-crossentropy/crossentropy_entropy_formula.png","alt":"Formula for KL divergence"}],"\nCross-entropy measures the average surprisal of model ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]}]]}]," on data from ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}],". When ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"p"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"q"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p = q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]]}]]}],", we call it entropy."]}]}]]}],"\n",["$","h2",null,{"children":"KL = cross-entropy - entropy"}],"\n",["$","p",null,{"children":["Quick refresher: In the ",["$","$L17",null,{"href":"01-kl_intro","children":"previous chapter"}],", we saw how KL divergence comes from repeatedly using Bayes' theorem with log-space updating:"]}],"\n",["$","$L18",null,{"highlightSurprisals":true}],"\n",["$","p",null,{"children":["Each step adds surprisals (",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"log"}],["$","mo",null,{"children":"⁡"}],["$","mn",null,{"children":"1"}],["$","mi",null,{"mathvariant":"normal","children":"/"}],["$","mi",null,{"children":"p"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\log 1/p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mop","children":["lo",["$","span",null,{"style":{"marginRight":"0.01389em"},"children":"g"}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":"1/"}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}],") to track evidence.\nLast time, we focused on the differences between surprisals to see how much evidence we got for each hypothesis. Our Bayesian detective just keeps adding up these differences."]}],"\n",["$","p",null,{"children":["But the detective could also add up the total surprisal for each hypothesis (green and orange numbers in the above widget), and then compare overall ",["$","em",null,{"children":"Total surprisal"}],"  values. This corresponds to writing KL divergence like this:"]}],"\n",["$","$L19",null,{"id":"cross-entropy-decomp","displayMode":true,"math":"\n\\underbrace{\\sum_{i = 1}^n p_i \\log \\frac{p_i}{q_i}}_{D(p,q)}\n\\;\\;\\;=\\;\\;\\;\n\\underbrace{\\sum_{i = 1}^n p_i \\log \\frac{1}{q_i}}_{H(p,q)}\n\\;\\;\\;-\\;\\;\\;\n\\underbrace{\\sum_{i = 1}^n p_i \\log \\frac{1}{p_i}}_{H(p)}\n"}],"\n",["$","p",null,{"children":["These two pieces on the right are super important: ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"H"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"p"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"q"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"H(p,q)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.08125em"},"children":"H"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}],["$","span",null,{"className":"mclose","children":")"}]]}]}]]}]," is called cross-entropy and ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"H"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"p"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"H(p)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.08125em"},"children":"H"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mclose","children":")"}]]}]}]]}]," is entropy. Let's build intuition for what they mean."]}],"\n",["$","h2",null,{"children":["Cross-entropy ",["$","a",null,{"id":"cross"}]]}],"\n",["$","p",null,{"children":["Think of cross-entropy as: ",["$","strong",null,{"children":["how surprised you are on average when seeing data from ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}]," while modeling it as ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]}]]}],"?"]}]]}],"\n",["$","p",null,{"children":["Explore this in the widget below. The widget shows what happens when our Bayesian detective from the previous chapter keeps flipping her coin. The red dashed line is showing cross-entropy - the expected surprisal of the model ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]}]]}]," as we keep flipping the coin with bias ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}],". The orange line shows the entropy—this is the expected surprisal when both the model and actual bias are ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}],".\nKL divergence is the difference between cross-entropy and entropy. Notice that the cross-entropy line is always above the entropy line (equivalently, KL divergence is always positive)."]}],"\n",["$","p",null,{"children":["If you let the widget run, you will also see a blue and a green curve - the actual surprisal measured by our detective in the flipping simulation. We could also say that these curves measure cross-entropy—it's the cross-entropy between the ",["$","em",null,{"children":"empirical distribution"}]," ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mover",null,{"accent":"true","children":[["$","mi",null,{"children":"p"}],["$","mo",null,{"children":"^"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\hat{p}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8889em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord accent","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.6944em"},"children":[["$","span",null,{"style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}],["$","span",null,{"style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"accent-body","style":{"left":"-0.1667em"},"children":["$","span",null,{"className":"mord","children":"^"}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1944em"},"children":["$","span",null,{}]}]}]]}]}]]}]}]]}]," (the actual outcomes of the flips) and the model ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]}]]}]," (blue curve) or ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}]," (green curve). The empirical cross-entropies are tracking the dashed lines due to the ",["$","$L17",null,{"href":"https://en.wikipedia.org/wiki/Law_of_large_numbers","children":"law of large numbers"}],"."]}],"\n",["$","$L1a",null,{}],"\n",["$","p",null,{"children":["Bottom line: ",["$","em",null,{"children":"Better models are less surprised by the data and have smaller cross-entropy. KL divergence measures how far our model is from the best one."}]]}],"\n",["$","h2",null,{"children":"Entropy"}],"\n",["$","p",null,{"children":["The term ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"H"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"p"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"H"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"p"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"p"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"="}],["$","msubsup",null,{"children":[["$","mo",null,{"children":"∑"}],["$","mrow",null,{"children":[["$","mi",null,{"children":"i"}],["$","mo",null,{"children":"="}],["$","mn",null,{"children":"1"}]]}],["$","mi",null,{"children":"n"}]]}],["$","msub",null,{"children":[["$","mi",null,{"children":"p"}],["$","mi",null,{"children":"i"}]]}],["$","mi",null,{"children":"log"}],["$","mo",null,{"children":"⁡"}],["$","mn",null,{"children":"1"}],["$","mi",null,{"mathvariant":"normal","children":"/"}],["$","msub",null,{"children":[["$","mi",null,{"children":"p"}],["$","mi",null,{"children":"i"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"H(p) = H(p, p) = \\sum_{i = 1}^n p_i \\log 1 / p_i"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.08125em"},"children":"H"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.08125em"},"children":"H"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.104em","verticalAlign":"-0.2997em"}}],["$","span",null,{"className":"mop","children":[["$","span",null,{"className":"mop op-symbol small-op","style":{"position":"relative","top":"0em"},"children":"∑"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8043em"},"children":[["$","span",null,{"style":{"top":"-2.4003em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"i"}],["$","span",null,{"className":"mrel mtight","children":"="}],["$","span",null,{"className":"mord mtight","children":"1"}]]}]}]]}],["$","span",null,{"style":{"top":"-3.2029em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"n"}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.2997em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mop","children":["lo",["$","span",null,{"style":{"marginRight":"0.01389em"},"children":"g"}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":"1/"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3117em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"i"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]]}]]}]," is a special case of cross-entropy called just plain ",["$","em",null,{"children":"entropy"}],". It's the best possible cross-entropy you can get for distribution ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}],"—when you model it perfectly as itself."]}],"\n",["$","p",null,{"children":["Intuitively, entropy tells you how much surprisal or uncertainty is baked into ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}],". Even if you know you're flipping a fair coin and hence ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"p"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"q"}],["$","mo",null,{"children":"="}],["$","mfrac",null,{"children":[["$","mn",null,{"children":"1"}],["$","mn",null,{"children":"2"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p = q = \\frac12"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.1901em","verticalAlign":"-0.345em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mopen nulldelimiter"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8451em"},"children":[["$","span",null,{"style":{"top":"-2.655em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"2"}]}]}]]}],["$","span",null,{"style":{"top":"-3.23em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line","style":{"borderBottomWidth":"0.04em"}}]]}],["$","span",null,{"style":{"top":"-3.394em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"1"}]}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.345em"},"children":["$","span",null,{}]}]}]]}]}],["$","span",null,{"className":"mclose nulldelimiter"}]]}]]}]]}]]}],", you still don't know which way the coin will land. There's inherent uncertainty in that—the outcome still carries surprisal, even if you know the coin's bias. This is what entropy measures."]}],"\n",["$","p",null,{"children":["The fair coin's entropy is ",["$","$L19",null,{"math":"H(\\{\\textsf{H: }1/2, \\textsf{T: }1/2\\}) = \\frac12\\cdot \\log2 +  \\frac12\\cdot \\log2 = 1"}]," bit.\nBut entropy can get way smaller than 1 bit. If you flip a biased coin where heads are very unlikely—say ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"p"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mtext",null,{"mathvariant":"sans-serif","children":"H"}],["$","mo",null,{"children":"="}],["$","mn",null,{"children":"0.05"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p(\\textsf{H} = 0.05)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord textsf","children":"H"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":"0.05"}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}],"—the entropy of the flip gets close to zero. Makes sense! Sure, if you happen to flip heads, that's super surprising (",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"log"}],["$","mo",null,{"children":"⁡"}],["$","mn",null,{"children":"1"}],["$","mi",null,{"mathvariant":"normal","children":"/"}],["$","mn",null,{"children":"0.05"}],["$","mo",null,{"children":"≈"}],["$","mn",null,{"children":"4.32"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\log 1/0.05 \\approx 4.32"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mop","children":["lo",["$","span",null,{"style":{"marginRight":"0.01389em"},"children":"g"}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord","children":"1/0.05"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"≈"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6444em"}}],["$","span",null,{"className":"mord","children":"4.32"}]]}]]}]]}],"). However, most flips are boringly predictable tails, so the ",["$","em",null,{"children":"average"}]," surprise gets less than 1 bit. You can check in the widget below that ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"H"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mo",null,{"stretchy":"false","children":"{"}],["$","mtext",null,{"mathvariant":"sans-serif","children":"H"}],["$","mo",null,{"children":":"}],["$","mn",null,{"children":"0.05"}],["$","mo",null,{"separator":"true","children":","}],["$","mtext",null,{"mathvariant":"sans-serif","children":"T"}],["$","mo",null,{"children":":"}],["$","mn",null,{"children":"0.95"}],["$","mo",null,{"stretchy":"false","children":"}"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"≈"}],["$","mn",null,{"children":"0.29"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"H(\\{\\textsf{H}: 0.05, \\textsf{T}: 0.95\\}) \\approx 0.29"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.08125em"},"children":"H"}],["$","span",null,{"className":"mopen","children":"({"}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord textsf","children":"H"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":":"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8889em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord","children":"0.05"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord textsf","children":"T"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":":"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":"0.95"}],["$","span",null,{"className":"mclose","children":"})"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"≈"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6444em"}}],["$","span",null,{"className":"mord","children":"0.29"}]]}]]}]]}]," bits per flip. Entropy hits zero when one outcome has 100% probability."]}],"\n",["$","p",null,{"children":["Entropy can also get way bigger than 1 bit. Rolling a die has entropy ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","msub",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"log"}],["$","mo",null,{"children":"⁡"}]]}],["$","mn",null,{"children":"2"}]]}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mn",null,{"children":"6"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"children":"≈"}],["$","mn",null,{"children":"2.6"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\log_2(6) \\approx 2.6"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mop","children":[["$","span",null,{"className":"mop","children":["lo",["$","span",null,{"style":{"marginRight":"0.01389em"},"children":"g"}]]}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.207em"},"children":["$","span",null,{"style":{"top":"-2.4559em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"2"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.2441em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord","children":"6"}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"≈"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6444em"}}],["$","span",null,{"className":"mord","children":"2.6"}]]}]]}]]}]," bits. In general, a uniform distribution over ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"k"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"k"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03148em"},"children":"k"}]]}]}]]}]," options has entropy ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","msub",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"log"}],["$","mo",null,{"children":"⁡"}]]}],["$","mn",null,{"children":"2"}]]}],["$","mi",null,{"children":"k"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\log_2 k"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.9386em","verticalAlign":"-0.2441em"}}],["$","span",null,{"className":"mop","children":[["$","span",null,{"className":"mop","children":["lo",["$","span",null,{"style":{"marginRight":"0.01389em"},"children":"g"}]]}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.207em"},"children":["$","span",null,{"style":{"top":"-2.4559em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"2"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.2441em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03148em"},"children":"k"}]]}]}]]}],", which is the maximum entropy possible for ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"k"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"k"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03148em"},"children":"k"}]]}]}]]}]," options. Makes sense—you're most surprised on average when the distribution is, in a sense, most uncertain."]}],"\n",["$","$L1b",null,{"numCategories":6,"title":"Entropy of die-rolling"}],"\n",["$","$L1c",null,{"headline":"Example: correct horse battery staple","children":[["$","p",null,{"children":["Here's an example. Let's say there are about ",["$","$L19",null,{"math":"2^{11}"}]," English words that can be described as 'common'. If you generate uniformly four such common words and make your password the concatenation of them, the total entropy of your password is thus going to be ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mn",null,{"children":"44"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"44"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6444em"}}],["$","span",null,{"className":"mord","children":"44"}]]}]}]]}]," bits. That's because entropy is a special case of cross-entropy and is thus additive."]}],["$","p",null,{"children":["Having a uniform distribution with 44 bits of entropy is just a different way of saying that we have a uniform distribution with ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mn",null,{"children":"2"}],["$","mn",null,{"children":"44"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"2^{44}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8141em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord","children":"2"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8141em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"44"}]}]}]]}]}]}]}]}]]}]]}]}]]}]," possible outcomes.\nThis comic wisely teaches us that this many possibilities make it a pretty secure password! Even if an adversary knows how we generated it, cracking it means they have to check about ",["$","$L19",null,{"math":"2^{44}"}]," passwords."]}],["$","a",null,{"href":"https://xkcd.com/936/","target":"_blank","rel":"noopener noreferrer","children":["$","img",null,{"src":"02-crossentropy/password.png","alt":"password","style":{"cursor":"pointer"}}]}]]}],"\n",["$","h2",null,{"children":"Relative entropy"}],"\n",["$","p",null,{"children":["KL divergence can be interpreted as the gap between cross-entropy and entropy. It tells us how far your average surprisal (cross-entropy) is from the best possible (entropy).\nThat's why in some communities, people call KL divergence the ",["$","em",null,{"children":"relative entropy"}]," between ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"p"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"p"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"p"}]]}]}]]}]," and ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.625em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.03588em"},"children":"q"}]]}]}]]}],". ",["$","$L1d",null,{"children":"Way better name than 'KL divergence' if you ask me. But 'KL divergence' is what most people use, so I guess we're stuck with it. "}]]}],"\n",["$","h2",null,{"children":["What's next? ",["$","a",null,{"id":"next-steps"}]]}],"\n",["$","p",null,{"children":"We're getting the hang of KL divergence, cross-entropy, and entropy! Quick recap:"}],"\n",["$","p",null,{"children":["$","$L16",null,{"src":"02-crossentropy/crossentropy_entropy_formula.png","alt":"Formula for KL divergence"}]}],"\n",["$","p",null,{"children":["In the ",["$","$L17",null,{"href":"03-entropy_properties","children":"next chapter"}],", we will do a recap of what kind of properties these functions have and then we are ready to get to the cool stuff."]}]],["$","$L1e",null,{"headerLevel":0}],["$","$L1f",null,{}],["$","div",null,{"className":"mt-16 pt-8 border-t border-gray-200","children":["$","div",null,{"className":"flex justify-between items-center","children":[["$","div",null,{"className":"flex-1","children":["$","$L12",null,{"href":"/01-kl_intro/","className":"inline-flex items-center text-blue-600 hover:text-blue-800 transition-colors","children":[["$","svg",null,{"className":"w-5 h-5 mr-2","fill":"none","stroke":"currentColor","viewBox":"0 0 24 24","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":2,"d":"M15 19l-7-7 7-7"}]}],["$","div",null,{"className":"text-left","children":[["$","div",null,{"className":"text-sm text-gray-500","children":"Previous"}],["$","div",null,{"className":"font-medium","children":"Bayes & KL divergence"}]]}]]}]}],["$","div",null,{"className":"flex-1 text-right","children":["$","$L12",null,{"href":"/03-entropy_properties/","className":"inline-flex items-center justify-end text-blue-600 hover:text-blue-800 transition-colors","children":[["$","div",null,{"className":"text-right","children":[["$","div",null,{"className":"text-sm text-gray-500","children":"Next"}],["$","div",null,{"className":"font-medium","children":"KL & Entropy properties"}]]}],["$","svg",null,{"className":"w-5 h-5 ml-2","fill":"none","stroke":"currentColor","viewBox":"0 0 24 24","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":2,"d":"M9 5l7 7-7 7"}]}]]}]}]]}]}]]}]}]}]}]
b:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
8:null
9:null
d:[["$","title","0",{"children":"Bayes, bits & brains"}],["$","meta","1",{"name":"description","content":"Bayes, bits & brains"}]]
